# Combined Learning of Linear Parameter-Varying Models and Robust Control Invariant Sets
This repository contains the code for the paper "Combined Learning of Linear Parameter-Varying Models and Robust Control Invariant Sets" by S.K.Mulagaleti and A.Bemporad

## Requirements

This project requires the following Python packages:

- [jax](https://github.com/google/jax)
- [jax.numpy](https://jax.readthedocs.io/en/latest/jax.numpy.html)
- [jax.scipy](https://jax.readthedocs.io/en/latest/jax.scipy.html)
- [numpy](https://numpy.org/)
- [flax](https://github.com/google/flax)
- [jax_sysid](https://github.com/bemporad/jax-sysid)
- [jaxopt](https://github.com/google/jaxopt)
- [qpax](https://github.com/kevin-tracy/qpax)
- [casadi](https://web.casadi.org/)
- [matplotlib](https://matplotlib.org/)
- [pycvxset](https://github.com/merlresearch/pycvxset) 
- [scipy](https://www.scipy.org/)
- [control](https://python-control.readthedocs.io/)

## How to run the code
The main file to run is 'main.py'. This file consists of the following three main parts:
1. Generate/Load dataset
2. qLPV identification
3. Concurrent identification

All three parts output a pickle file containing the results.
These files are present in the folder 'identification_results/$folder_name'
If the file already exists, the results are not recomputed.
To recompute the results, set overwrite_data = True in the function call.

In Step 1: 
- Select the plant model and the number of training and testing samples.
- The base class for plant models is in plant_models/plant_model.py
- The function to generate the dataset is in data_generation.py
- The options to pass to this function are:
    - scale_data: Boolean to scale the data or not
    - N_train: Number of training samples
    - N_test: Number of testing samples
    - overwrite_data: Boolean to overwrite the existing dataset or not
- By default, the inputs in the dataset are generated by randomly sampling from the input constraints.
- By uncommenting the line 'U_tot = generate_multisine(nu, N_train, 0.1, 100, -system.u_lim, system.u_lim, 10)' in data_generation.py, the inputs are generated using a multi-sine signal.


## Installation

You can install a part of the required packages using `pip`:

```bash
pip install jax jaxlib numpy flax jax-sysid jaxopt qpax casadi matplotlib scipy control
